---
layout: article
title: "Gradle é…ç½®è§£é‡Š - subprojects & clean"
date: 2025-07-16
permalink: /android/gradle-pei-zhi-jie-shi-subprojects-clean/
tags: ["Android"]
---

## ğŸ”§ ç¬¬ä¸€ä¸ªé…ç½®ï¼šsubprojects å—

```kotlin
subprojects {
    // Apply ktlint formatting to all modules
    apply(plugin = "org.jlleitschuh.gradle.ktlint")
}
```

### **ä½œç”¨**ï¼š
- **æ‰¹é‡åº”ç”¨æ’ä»¶**ï¼šå¯¹é¡¹ç›®ä¸­çš„æ‰€æœ‰å­æ¨¡å—ï¼ˆsubprojectsï¼‰åº”ç”¨ ktlint æ’ä»¶
- **ä»£ç æ ¼å¼åŒ–**ï¼šktlint æ˜¯ Kotlin ä»£ç é£æ ¼æ£€æŸ¥å’Œè‡ªåŠ¨æ ¼å¼åŒ–å·¥å…·

### **å…·ä½“å«ä¹‰**ï¼š
- `subprojects` = éå†é¡¹ç›®ä¸­æ‰€æœ‰å­æ¨¡å—ï¼ˆæ¯”å¦‚ `app` æ¨¡å—ï¼‰
- `apply(plugin = "org.jlleitschuh.gradle.ktlint")` = ç»™æ¯ä¸ªå­æ¨¡å—æ·»åŠ  ktlint æ’ä»¶
- **æ•ˆæœ**ï¼šæ‰€æœ‰æ¨¡å—éƒ½ä¼šæœ‰ç»Ÿä¸€çš„ Kotlin ä»£ç æ ¼å¼æ£€æŸ¥

### **å®é™…ç”¨é€”**ï¼š
```bash
# æ£€æŸ¥ä»£ç æ ¼å¼
./gradlew ktlintCheck

# è‡ªåŠ¨ä¿®å¤æ ¼å¼é—®é¢˜
./gradlew ktlintFormat
```

## ğŸ§¹ ç¬¬äºŒä¸ªé…ç½®ï¼šclean ä»»åŠ¡

```kotlin
tasks.register("clean", Delete::class) {
    delete(rootProject.buildDir)
}
```

### **ä½œç”¨**ï¼š
- **åˆ›å»ºæ¸…ç†ä»»åŠ¡**ï¼šæ³¨å†Œä¸€ä¸ªåä¸º "clean" çš„ Gradle ä»»åŠ¡
- **åˆ é™¤æ„å»ºæ–‡ä»¶**ï¼šæ¸…é™¤æ‰€æœ‰ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶

### **å…·ä½“å«ä¹‰**ï¼š
- `tasks.register("clean", Delete::class)` = åˆ›å»ºä¸€ä¸ªåˆ é™¤ç±»å‹çš„ä»»åŠ¡
- `delete(rootProject.buildDir)` = åˆ é™¤æ ¹é¡¹ç›®çš„ build ç›®å½•
- **æ•ˆæœ**ï¼šæ‰§è¡Œ `./gradlew clean` æ—¶ä¼šåˆ é™¤æ‰€æœ‰ç¼–è¯‘äº§ç‰©

### **å®é™…ç”¨é€”**ï¼š
```bash
# æ¸…ç†æ‰€æœ‰ç¼–è¯‘æ–‡ä»¶ï¼ˆç›¸å½“äº"é‡ç½®"é¡¹ç›®ï¼‰
./gradlew clean

# å¸¸ç”¨ç»„åˆï¼šå…ˆæ¸…ç†ï¼Œå†æ„å»º
./gradlew clean build
```

## ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦è¿™äº›é…ç½®ï¼Ÿ

### **ktlint çš„é‡è¦æ€§**ï¼š
- **å›¢é˜Ÿåä½œ**ï¼šç¡®ä¿æ‰€æœ‰å¼€å‘è€…å†™å‡ºæ ¼å¼ä¸€è‡´çš„ä»£ç 
- **ä»£ç è´¨é‡**ï¼šè‡ªåŠ¨å‘ç°æ½œåœ¨çš„ä»£ç é£æ ¼é—®é¢˜
- **è‡ªåŠ¨åŒ–**ï¼šCI/CD æµç¨‹ä¸­è‡ªåŠ¨æ£€æŸ¥ä»£ç æ ¼å¼

### **clean ä»»åŠ¡çš„é‡è¦æ€§**ï¼š
- **è§£å†³æ„å»ºé—®é¢˜**ï¼šå½“é¡¹ç›®å‡ºç°å¥‡æ€ªé”™è¯¯æ—¶ï¼Œç¬¬ä¸€æ­¥é€šå¸¸æ˜¯ clean
- **ç¡®ä¿å¹²å‡€æ„å»º**ï¼šåˆ é™¤ç¼“å­˜æ–‡ä»¶ï¼Œé¿å…æ—§æ–‡ä»¶å½±å“æ–°æ„å»º
- **æ€§èƒ½ä¼˜åŒ–**ï¼šå®šæœŸæ¸…ç†å¯ä»¥é‡Šæ”¾ç£ç›˜ç©ºé—´

### **Android å¼€å‘ä¸­çš„å®é™…åº”ç”¨**ï¼š
```bash
# é‡åˆ°å¥‡æ€ªç¼–è¯‘é”™è¯¯æ—¶çš„æ ‡å‡†æµç¨‹
./gradlew clean          # æ¸…ç†
./gradlew ktlintFormat   # æ ¼å¼åŒ–ä»£ç   
./gradlew build          # é‡æ–°æ„å»º
```

## ğŸ’¡ å­¦ä¹ è¦ç‚¹

è¿™ä¸¤ä¸ªé…ç½®ä½“ç°äº†**ç°ä»£ Android é¡¹ç›®çš„æœ€ä½³å®è·µ**ï¼š

1. **è‡ªåŠ¨åŒ–ä»£ç è´¨é‡**ï¼šktlint ç¡®ä¿ä»£ç é£æ ¼ä¸€è‡´
2. **æ ‡å‡†åŒ–æ„å»ºæµç¨‹**ï¼šclean ä»»åŠ¡è§£å†³æ„å»ºé—®é¢˜
3. **é¡¹ç›®å¯ç»´æŠ¤æ€§**ï¼šå›¢é˜Ÿå¼€å‘ä¸­çš„é‡è¦å·¥å…·
