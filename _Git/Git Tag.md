---
layout: article
title: "Git Tag"
date: 2025-05-29
permalink: /git/git-tag/
tags: ["基础知识", "Git"]
---

`git tag` 是 用来给项目的某个 **关键版本** 打上一个 **永久的“版本标签”**， 给某次提交贴一个名字，通常用于标记 **版本号**、**发布点**、**重要里程碑**。

### 🧠 举个例子：

你完成了第一个正式版本 `v1.0.0`，这时候：

```bash
git tag v1.0.0
```

你就给当前的提交打上了一个叫 `v1.0.0` 的“标签”。

以后无论你代码怎么变，你都能随时用它回到这个版本：

```bash
git checkout v1.0.0
```

### ✅ 标签类型

Git 支持两种标签：

| 类型                     | 命令                                   | 说明                           |
| ---------------------- | ------------------------------------ | ---------------------------- |
| **轻量标签**               | `git tag v1.3.0`                     | 只是给某个提交起了个名字，没有额外信息          |
| **注解标签（annotated）✅推荐** | `git tag -a v1.3.0 -m "正式发布 v1.0.0"` | 包含作者、日期、说明、GPG 签名等元数据，适合发布版本 |
#### 📌 什么是 “带注解标签”？

`-a` 是 `--annotate` 的缩写。相当于写：
```bash
git tag --annotate v1.3.0 --message "正式发布"
```

它会保存更多信息，比如：

- 标签创建者是谁
- 创建日期
- 标签说明（版本更新内容）
- 可选：GPG 签名（验证身份）
    
你可以这样查看一个带注解的标签信息：
```bash
git show v1.3.0
```

会显示：
```bash
tag v1.3.0 Tagger: Carrie <carrie@example.com> Date:   2025-05-29  正式发布 v1.3.0  commit 4f76a24bd... Author: Carrie ...
```

❌ 如果你用轻量标签（不推荐发布时用）：
```bash
git tag v1.3.0
```

它不会记录作者/说明/时间，只是一个“指针”。

### ✅ 常用命令大全

|命令|作用|
|---|---|
|`git tag`|查看已有的所有标签|
|`git tag -a v1.2.0 -m "发布 v1.2.0"`|创建带注解的标签|
|`git show v1.2.0`|查看标签对应的提交信息|
|`git push origin v1.2.0`|推送单个标签到远程仓库|
|`git push origin --tags`|推送所有标签到远程仓库|
|`git checkout v1.2.0`|切换到某个标签（只读）|
|`git tag -d v1.2.0`|删除本地标签|
|`git push origin :refs/tags/v1.2.0`|删除远程标签|

### ✅ 推荐实践：配合发布版本号使用

在每次发布 Flutter 新版本时，你可以这样操作：

```bash
# 1. 修改 pubspec.yaml
version: 1.2.0+5

# 2. 提交代码
git add .
git commit -m "Release v1.2.0"

# 3. 打标签
git tag -a v1.2.0 -m "正式发布版本 1.2.0"

# 4. 推送到远程仓库
git push origin main
git push origin v1.2.0
```

然后你就可以在 GitHub 的 **Releases** 页面自动看到这个标签啦 🎉

### ❗**不是每次推送都要打标签！**

> Q: 如果我本地有一些小的修改，我要推送到git以保存进度，是否每次推送都要打个标签呢？

>👉 标签（tag）是用来标记“重要版本”，比如：
> - 发布版本
> - 上线前快照
> - 特定版本回滚点

日常保存进度、普通提交，**只需要：**

```bash
git add .
git commit -m "修复了按钮颜色"
git push origin main
```

✅ **不需要打 tag！**

🧠 你可以这样理解：

| 你想做的事            | 用什么命令                                |
| ---------------- | ------------------------------------ |
| 📝 日常保存代码进度      | `git commit` + `git push`            |
| 🏁 给“某次重要提交”起个名字 | `git tag`                            |
| 📦 发布正式版本        | `git tag` + `git push origin vX.X.X` |
| 🕹 想随时跳回某个旧版本    | `git tag` 是你的“还原点” 。tag是版本锚点         |

### 🧩 举个例子来说明差异

你在做一个 Flutter App：

 ✅ 日常开发（不打标签）：

```bash
git add .
git commit -m "调整首页 UI 布局"
git push origin main
```

🎯 只是把进度保存到 GitHub，不需要打 tag。

✅ 准备发布到应用商店（正式版本）：

```bash
git commit -m "发布 v1.0.0"
git tag -a v1.0.0 -m "首次发布"
git push origin main
git push origin v1.0.0
```

📌 这时候打 tag 是为了：

- 标记这是一个“正式版本”
- 以后你能回滚到这个版本
- GitHub 的 Release 页面能展示这个版本
    
---
### ❗功能更新要打标签

> 那么当有功能更新时，例如从 v1.2.1 -> v1.3.0 ，需要打tag吗？

✅ 是的！当你有功能更新并且决定发布 `v1.3.0` 时，**强烈推荐**打一个 `tag`。这是版本控制的最佳实践之一。

|理由|说明|
|---|---|
|🧭 **标记清晰的“版本分界线”**|`v1.2.1 → v1.3.0` 就是一段迭代的结束，也是新版本的开始|
|📦 **打包发布需要稳定锚点**|你构建 APK / IPA 或发到应用市场时需要“确定版本”|
|⏪ **方便未来回滚**|如果 `v1.3.0` 有 bug，你可以轻松回到 `v1.2.1`|
|📝 **配合 GitHub Release 管理变更记录**|tag 是自动展示 release 的基础|
|👥 **团队协作更清楚**|别人一看 tag 就知道：“哦，这个版本发布过了”|

### 🧩 举例：从 v1.2.1 → v1.3.0

你开发完成并准备发布新功能时，应该这样做：

```bash
# 修改 pubspec.yaml
version: 1.3.0+5

# 提交变更
git add .
git commit -m "发布 v1.3.0，新增收藏功能"

# 打标签
git tag -a v1.3.0 -m "正式发布 v1.3.0：新增收藏功能"

# 推送代码和标签
git push origin main
git push origin v1.3.0
```

### ✅ 打了 tag，有什么好处？

- 在 GitHub 的 Releases 页面看到 `v1.3.0`
- 用 `git log --oneline --decorate` 一眼看到你每次发布点
- 将来查 bug 时快速回退到：
    ```bash
    git checkout v1.2.1
    ```
    
### ✅ 什么时候打 tag？

| 是否发布功能版本？                 | 是否打 tag？   | 说明  |
| ------------------------- | ---------- | --- |
| 🧪 只是在写代码保存、每天保存进度、普通开发提交 | ❌ 不打       |     |
| ✅ 准备发布新功能版本（比如 v1.3.0）    | ✅ 必打       |     |
| 🐞 修 bug 并准备发布（如 v1.3.1）  | ✅ 也要打      |     |
| 💡 每次构建发布包（即用户能拿到的版本）     | ✅ 都应该打 tag |     |
| 💡做版本备份                   | ✅ 要打       |     |
| 💡作为回滚点（比如上线后出 bug）       | ✅ 要打       |     |

## 🔚 总结

> **日常保存用 `commit + push`，重大节点用 `tag`。**

|功能|类比|
|---|---|
|`commit`|拍了一张快照|
|`tag`|给这张快照写了个名字，比如 `v1.2.0`|
|`push tag`|把这张命名的快照发布给大家看|
